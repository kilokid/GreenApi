"use strict";(self.webpackChunkgreen_api=self.webpackChunkgreen_api||[]).push([[411],{7411:function(e,t,n){n.r(t),n.d(t,{default:function(){return d}});var r=n(1413),a=n(4165),s=n(5861),c=n(2791),i=n(887),u=n(9434),o=n(4098),l=n(7921),p=n(487),f=n(184),d=function(){var e=(0,u.v9)((function(e){return e.login})),t=e.id,n=e.apiToken,d=(0,u.v9)((function(e){return e.chat.chatId})),m=(0,i.cI)({mode:"onBlur"}),h=m.register,g=m.handleSubmit,v=(0,u.v9)((function(e){return e.message})),x=(0,u.I0)(),_=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(r){var s,c,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&n&&d)){e.next=13;break}return s=r.message,e.prev=2,e.next=5,x((0,l.BE)({id:t,apiToken:n,chatId:d,message:s}));case 5:c=e.sent,i={receiptId:c.payload.id,text:c.payload.message,type:"outgoing"},x((0,p.H)(i)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log("error request"+e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(r){var s,c,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==r&&void 0!==r&&r.hasOwnProperty("body")&&null!==r){e.next=2;break}return e.abrupt("return");case 2:return"outgoingAPIMessageReceived"===(s=r.body.typeWebhook)?s="outgoing":"incomingMessageReceived"===s&&(s="incoming"),e.next=6,(0,o.Pi)(t,n,r.receiptId);case 6:200===e.sent.status&&(c=r.body.messageData.textMessageData.textMessage,i={receiptId:r.receiptId,text:c,type:"incoming"},x((0,p.H)(i)));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,c.useEffect)((function(){var e=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,o.FC)(t,n);case 3:if(!(r=e.sent)){e.next=7;break}return e.next=7,k(r.data);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("\u041e\u0448\u0438\u0431\u043a\u0430: ",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),r=setInterval(e,5e3);return function(){clearInterval(r)}}),[]),(0,f.jsxs)("section",{className:"chat",children:[(0,f.jsx)("ul",{className:"chat__messages",children:v.map((function(e){var t=e.receiptId,n=e.text,r="outgoing"===e.type?"chat__message chat__message--me":"chat__message";return(0,f.jsx)("li",{className:r,children:n},t)}))}),(0,f.jsx)("form",{className:"chat__form",onSubmit:g(_),children:(0,f.jsx)("ul",{className:"chat__form-wrapper",children:(0,f.jsx)("li",{className:"chat__form-field",children:(0,f.jsx)("input",(0,r.Z)((0,r.Z)({className:"chat__form-input"},h("message",{required:"Please enter message"})),{},{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",type:"text"}))})})})]})}}}]);
//# sourceMappingURL=411.22dda810.chunk.js.map